---
title: "quantex_results"
author: "Nele-Pauline Suffo"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(lme4)
library(lmerTest)
```

```{r load-data}
utterance_01a_df <- read_csv("/Users/nelesuffo/Promotion/projects/leuphana-IPE/paper/data/utterance_01a_df.csv", show_col_types = FALSE)
utterance_01b_df <- read_csv("/Users/nelesuffo/Promotion/projects/leuphana-IPE/paper/data/utterance_01b_df.csv", show_col_types = FALSE)
utterance_01c_df <- read_csv("/Users/nelesuffo/Promotion/projects/leuphana-IPE/paper/data/utterance_01c_df.csv", show_col_types = FALSE)
# Make sure 'play_context' is a factor with the correct reference level
utterance_01a_df <- utterance_01a_df %>%
  mutate(play_context = factor(play_context, levels = c("alone", "social")),
         child_id = factor(child_id))

utterance_01b_df <- utterance_01b_df %>%
  mutate(object_class = factor(object_class),  # make sure it's a factor
         child_id = factor(child_id)) 

utterance_01c_df <- utterance_01c_df %>%
  mutate(child_id = factor(child_id),
         age_class = factor(person_age_class, levels = c("adult", "child")),
         face = factor(close_face_present, levels = c("no", "yes")),
         gaze = factor(gaze_direction, levels = c("no", "yes"))
        )
```

```{r glmm01a-alone-vs-social}
model_01a <- glmer(kchi_present ~ age * play_context + (play_context | child_id),
               data = utterance_01a_df,
               family = binomial)

summary(model_01a)
```
  

```{r glmm01b-alone}
model_01b <- glmer(kchi_present ~ age * object_class + (object_class | child_id),
                   data = utterance_01b_df,
                   family = binomial)
summary(model_01b)
```

```{r glmm01c-social}
# Fit the model#
# model_01c <- glmer(kchi_present ~ age * age_class * face * gaze +  (1 + age_class * face * gaze | child_id),
model_01c <- glmer(kchi_present ~ age * age_class  +  (1 | child_id),
                   data = utterance_01c_df,
                   family = binomial)
summary(model_01c)
```

